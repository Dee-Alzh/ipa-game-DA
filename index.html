<script>
  // IPA symbols for keyboard
  const ipaSymbols = [
    "ŋ","ɲ","ʃ","ʒ","θ","ð","ʔ","ʎ","ʁ","ɣ","χ","ħ","ʕ",
    "ɯ","ʏ","ø","œ","ɒ","ə","ʌ","ɜ","ɐ","ɨ","ʉ","æ"
  ];

  let activeInput = null; // store last focused input

  // Render keyboard
  const kb = document.getElementById("ipaKeys");
  ipaSymbols.forEach(sym => {
    const key = document.createElement("div");
    key.className = "ipa-key";
    key.textContent = sym;
    key.onclick = () => {
      if (activeInput) {
        activeInput.value += sym;
        activeInput.focus(); // keep cursor in box
      }
    };
    kb.appendChild(key);
  });

  // Game items
  const items = [
    { img: "feed.png", ipa: ["f","i","d"] },
    { img: "boo.png", ipa: ["b","u"] },
    { img: "feet.png", ipa: ["f","i","t"] }
  ];

  let index = 0;

  function showItem() {
    const item = items[index];
    document.getElementById("spectro").src = item.img;

    // Clear old inputs
    const inputArea = document.getElementById("answer-area");
    inputArea.innerHTML = "";

    // Create one input per IPA symbol
    item.ipa.forEach(() => {
      const inp = document.createElement("input");
      inp.className = "answer-box";
      inp.setAttribute("maxlength", "2");
      inp.style.width = "40px";

      // track focus
      inp.addEventListener("focus", () => activeInput = inp);

      inputArea.appendChild(inp);
    });

    document.getElementById("result").textContent = "";
    activeInput = null; // reset
  }

  function check() {
    const item = items[index];
    const inputs = document.querySelectorAll(".answer-box");
    let correctAll = true;

    inputs.forEach((inp, i) => {
      if (inp.value.trim() === item.ipa[i]) {
        inp.style.border = "2px solid lime";   // ✅ correct
      } else {
        inp.style.border = "2px solid red";    // ❌ wrong
        correctAll = false;
      }
    });

    if (correctAll) {
      document.getElementById("result").textContent = "✅ Correct word!";
      document.getElementById("result").style.color = "lime";
    } else {
      document.getElementById("result").textContent = "❌ Some sounds wrong";
      document.getElementById("result").style.color = "red";
    }
  }

  function next() {
    index = (index + 1) % items.length;
    showItem();
  }

  // Init first
  window.onload = showItem;
</script>
